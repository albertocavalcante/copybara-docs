---
title: Metadata Module Reference
description: Reference for metadata.* functions
---

# Metadata Module Reference

The `metadata` module provides commit message and metadata transformations.

## Commit Message

### metadata.squash_notes

Customize squash commit message:

```starlark
metadata.squash_notes(
    prefix = "Changes:\n",              # Text before notes
    show_author = True,                 # Include authors
    show_description = True,            # Include descriptions
    oldest_first = False,               # Order by oldest first
    max = 100,                          # Max notes to include
    compact = False,                    # Compact format
)
```

### metadata.replace_message

Replace entire commit message:

```starlark
metadata.replace_message(
    "New commit message",               # New message
)
```

### metadata.add_header

Add text to commit message:

```starlark
metadata.add_header(
    text = "Header text",               # Text to add
    new_line = True,                    # Add newline before
    ignore_label_not_found = False,     # Don't fail on missing label
)
```

## Labels

### metadata.expose_label

Make label available:

```starlark
metadata.expose_label(
    "Label-Name",                       # Label to expose
)
```

### metadata.remove_label

Remove label from message:

```starlark
metadata.remove_label(
    "Internal-Label",                   # Label to remove
)
```

### metadata.save_author

Save author to label:

```starlark
metadata.save_author(
    label = "ORIGINAL_AUTHOR",          # Label name
)
```

### metadata.restore_author

Restore author from label:

```starlark
metadata.restore_author(
    label = "ORIGINAL_AUTHOR",          # Label name
    search_all_changes = True,          # Search all changes
)
```

## Author Mapping

### metadata.map_author

Map author emails:

```starlark
metadata.map_author({
    "old@email.com": "new@email.com",
})
```

### metadata.use_last_change

Use author from last change:

```starlark
metadata.use_last_change()
```

## Examples

### Preserve Co-authors

```starlark
transformations = [
    metadata.expose_label("Co-authored-by"),
    metadata.expose_label("Signed-off-by"),
]
```

### Custom Squash Message

```starlark
transformations = [
    metadata.squash_notes(
        prefix = "Imported changes:\n\n",
        show_author = True,
        show_description = True,
    ),
    metadata.add_header("Synced-From: internal"),
]
```

### Map Internal Emails

```starlark
transformations = [
    metadata.map_author({
        "alice@internal.corp": "alice@public.example.com",
        "bob@internal.corp": "bob@public.example.com",
    }),
]
```

## Next Steps

- [Authoring module reference](/copybara-docs/reference/authoring/)
- [Glob reference](/copybara-docs/reference/glob/)
